var inputBase=require("../base/inputBase/inputBase");var COUNTNUM;Component({behaviors:[inputBase],lifetimes:{detached:function(){this.clearStl()}},detached:function(){this.clearStl()},properties:{placeholderValue:{type:String,value:"请输入验证码"},options:{type:Object,value:{}},mobile:{type:Number,value:0},smsbtntxt:{type:String,value:"获取验证码"}},data:{whyImg:"https://webzj.netstatic.net/webzj_weixin/wxsmsqs.png",buttonDisColor:"background:rgba(0,0,0,0.50);opacity:0.6;",adjust:true,iValue:"",buttonStyle:"",nodes:"",loading:""},ready:function(){let buttonStyle="";let options=this.data.options;if(options.buttonBgColor){buttonStyle+=";background-color:"+options.buttonBgColor}if(options.buttonColor){buttonStyle+=";color:"+options.buttonColor}this.setData({buttonStyle:buttonStyle});if(options.buttonDisColor){this.setData({buttonDisColor:options.buttonDisColor})}},methods:{clearStl:function(){if(this.stl){clearInterval(this.stl)}},onWhy:function(){this.triggerEvent("showConfirm",{popContent:this.popContent})},doCopy:function(){wx.setClipboardData({data:this.realCopyNumber,success(res){}})},onclear:function(){this.setData({iValue:""});this.doFocus()},bindSmsInput:function(e){this.setData({iValue:e.detail.value})},onSendSms:function(){this.triggerEvent("inputBlur",{});if(!this.data.loading){this.triggerEvent("showCap",{show:true},{})}},onClearUpload:function(){this.setData({nodes:"",copyNumber:""})},onNeedUpload:function(res){let nodes=res.content;let copyNumber="";this.popContent=res.smsUpDep;let html=nodes.replace(/(.+:?)(<span id="number".+\>([^<]+)<\/span>:?)/,function($1,$2,$3,$4){this.realCopyNumber=$4;let list=[];for(let i=0,item;i<this.realCopyNumber.length;i++){item=this.realCopyNumber[i];if(i!=0&&i%4===0){list.push(" ")}list.push(item)}copyNumber=$3.replace(/(<span id="number".+\>)([^<]+)(<\/span>)/,function($1,$2,$3,$4){return $2+list.join("")+$4});return $2}.bind(this));this.setData({nodes:html,copyNumber:copyNumber})},onCountDown:function(){COUNTNUM=30;this.setData({smsbtntxt:COUNTNUM,loading:"countdown"});this.stl=setInterval(function(){if(--COUNTNUM>0){this.setData({smsbtntxt:COUNTNUM})}else{this.stl=clearInterval(this.stl);this.setData({smsbtntxt:"重新获取",loading:""});this.triggerEvent("canReSend",{},{})}}.bind(this),1e3)},onFocus:function(){this.triggerEvent("focus",{from:"sms-err"})}}});